<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
      layout:decorate="~{layout/default}">
<head>
    <meta charset="UTF-8">
    <title>帝一流</title>
    <link th:href="@{/static/plugin/bootstrap-table/bootstrap-table.css}" type="text/css" rel="stylesheet">
    <link th:href="@{/static/plugin/treegrid/css/jquery.treegrid.css}" type="text/css" rel="stylesheet">
</head>
<body>
<div  layout:fragment="cm-flex" class="cm-flex">
    <div class="cm-breadcrumb-container">
        <ol class="breadcrumb">
            <li><a href="#">系统管理</a></li>
            <li class="active">菜单管理</li>
        </ol>
    </div>
    <form id="cm-search" action="index.html" method="get">
        <input type="search" name="q" autocomplete="off" placeholder="Search...">
    </form>
</div>
<div layout:fragment="content" class="container-fluid">
    <div class="panel panel-default">
        <div class="panel-body auto-height">
            <div class="btn-group" role="group" id="toolbar">
                <button type="button" class="btn btn-default" id="addMenu"><i class="fa fa-fw fa-plus"></i></button>
                <button type="button" class="btn btn-default" id="editMenu"><i class="fa fa-fw fa-pencil"></i></button>
                <button type="button" class="btn btn-default" id="delMenu"><i class="fa fa-fw fa-trash-o"></i></button>
            </div>
            <table id="menu-table"></table>
        </div>
    </div>
</div>
<div layout:fragment="myJs">
    <script th:src="@{/static/plugin/bootstrap-table/bootstrap-table.js}"></script>
    <script th:src="@{/static/plugin/bootstrap-table/bootstrap-table-locale-all.js}"></script>
    <script th:src="@{/static/plugin/treegrid/js/bootstrap-table-treegrid.js}"></script>
    <script th:src="@{/static/plugin/treegrid/js/jquery.treegrid.js}"></script>
    <script th:inline="javascript">
        $(function () {
            var autoHeight = $("div.auto-height").height();
            var tableHeight = autoHeight - 0;

            var $table = $('#menu-table');
            $table.bootstrapTable({
                height: tableHeight,
                sidePagination: 'server',
                url: /*[[@{/sys/assetList}]]*/,
                method: 'post',
                toolbar: '#toolbar',
                // 条纹
                striped: true,
                idField: 'id',
                columns: [
                    {
                        field: 'ck',
                        checkbox: true
                    },
                    {
                        field: 'name',
                        title: '菜单名称'
                    },
                    {
                        field: 'type',
                        title: '类型',
                        align: 'center',
                        formatter: 'typeFormatter'
                    },
                    {
                        field: 'controller',
                        title: '控制器'
                    },
                    {
                        field: 'view',
                        title: '视图'
                    },
                    {
                        field: 'isMenu',
                        title: '导航菜单',
                        align: 'center',
                        formatter: function (v) {
                            if (v == 1){

                                return '是';
                            }

                            return '否';
                        }
                    },
                    {
                        field: 'sort',
                        title: '排序'
                    },
                    {
                        field: 'iconCss',
                        title: '图标',
                        align: 'center',
                        formatter: 'iconFormatter'
                    }
                ],
                treeShowField: 'name',
                parentIdField: 'pid',
                onLoadSuccess: function () {
                    $table.treegrid({
                        treeColumn: 1,
                        onChange: function () {
                            $table.bootstrapTable('resetWidth');
                        }
                    });
                }
            });
        });

        // 格式化类型
        function typeFormatter(value, row, index) {
            if (value === 'menu') {
                return '菜单';
            }
            if (value === 'button') {
                return '按钮';
            }
            if (value === 'node') {
                return '节点';
            }
            return '-';
        }

        // 格式化图标
        function iconFormatter(value, row, index) {
            return '<span class="' + value + '" ' +
                'style="display: inline-block;width: 16px;height: 16px;background-size: 16px 16px;"></span>';
        }

    </script>
</div>
</body>
</html>